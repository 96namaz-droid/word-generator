"""
–°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –≤–µ–±-–≤–µ—Ä—Å–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –æ—Ç—á—ë—Ç–æ–≤
"""
import sys
import webbrowser
import time
from threading import Timer
import uvicorn
from logger import app_logger

def open_browser():
    """–û—Ç–∫—Ä—ã–≤–∞–µ—Ç –±—Ä–∞—É–∑–µ—Ä —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞"""
    webbrowser.open('http://localhost:8000')

if __name__ == "__main__":
    print("="*70)
    print("üöÄ –ó–ê–ü–£–°–ö –í–ï–ë-–í–ï–†–°–ò–ò –ì–ï–ù–ï–†–ê–¢–û–†–ê –û–¢–ß–Å–¢–û–í")
    print("="*70)
    print()
    print("üìç –ê–¥—Ä–µ—Å–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞:")
    print("   ‚Ä¢ –° —ç—Ç–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞:     http://localhost:8000")
    print("   ‚Ä¢ –° –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤:     http://[IP-–∞–¥—Ä–µ—Å]:8000")
    print()
    print("üì± –î–ª—è –¥–æ—Å—Ç—É–ø–∞ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ —Ç–æ–π –∂–µ —Å–µ—Ç–∏:")
    print("   1. –£–∑–Ω–∞–π—Ç–µ IP –∞–¥—Ä–µ—Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ (ipconfig –≤ Windows)")
    print("   2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞: http://[IP]:8000")
    print()
    print("‚ö° –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏:")
    print("   ‚Ä¢ Ctrl+C - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä")
    print()
    print("="*70)
    print()
    
    # –û—Ç–∫—Ä—ã–≤–∞–µ–º –±—Ä–∞—É–∑–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã
    Timer(1.5, open_browser).start()
    
    app_logger.info("–ó–∞–ø—É—Å–∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –ø–æ—Ä—Ç—É 8000")
    
    try:
        # –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä
        uvicorn.run(
            "web_app:app",
            host="0.0.0.0",  # –°–ª—É—à–∞–µ–º –Ω–∞ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö (–¥–æ—Å—Ç—É–ø –∏–∑ —Å–µ—Ç–∏)
            port=8000,
            log_level="info",
            access_log=True
        )
    except KeyboardInterrupt:
        print("\n\n‚úÖ –°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
        app_logger.info("–í–µ–±-—Å–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    except Exception as e:
        print(f"\n\n‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: {e}")
        app_logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞: {e}")
        sys.exit(1)

